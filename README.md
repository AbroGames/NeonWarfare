> [!IMPORTANT]
> Для разработки проекта используется [кастомная сборка движка (Только для Windows)](https://cloud.abro.cc/s/ctYQn7TRaLngYa6). Она отличается названием, цветом иконки и тем, что при работе с векторами и матрицами вместо **float** используется **double**.
> Алсо, для работы требуются кастомные .NET сборки, котрые могут быть получены из нашего NuGet репозитория. Подключить его можно командой:
> ```
> dotnet nuget add source https://nuget.bronuh.ru/nuget/bronuh-nuget/v3/index.json -n BronuhGet
> ```
> В проекте используется **.NET 8**.

> [!NOTE]
> Перед тем как начинать кодить ограбленные караваны, ознакомься с [Wiki](https://github.com/AbroGames/NeonWarfare/wiki)

> [Последняя сборка игры (только для Windows)](https://cloud.abro.cc/s/eHji3prB9HE2D4g)

## Структура проекта
### Основные модули
Проект разделен на несколько модулей, каждый из которых отвечает за отдельную сцену или функциональность.

- **Scenes**: Содержит игровые сцены и их обработчики
  - `Root`: Самая верхнеуровневая сцена. Вызывает инициализцию других систем, содержит в себе сцену Game или MainMenu, а также ссылку на PackedScenesContainer.
  - `Game`: Сцена с игрой (не меню). Отвечает за инициализацию сети, подключение, управление общеигровым состоянием, содержит в себе сцену SafeWorld или BattleWorld.
  - `PackedScenesContainer`: Контейнер, который содержит ссылки на все прототипы сцен в игре (тип PackedScene).
  - `Screen`: Содержит набор сцен с интерфейсом пользователя (HUD, меню, экран загрузки, консоль сервера).
  - `World`: Содержит верхнеуровневые сцены SafeWorld и BattleWorld, а также все игровые объекты и их логику.

- **Scripts**: Содержит вспомогательный код, не содержит сцены
  - `Content`: Содержит контейнеры со ссылками на ресурсы игры (музыка, звуки, текстуры, частицы)
  - `KludgeBox`: Библиотека с наработками из других проектов (шина событий, перехват сетевых пакетов, логеры, таймеры и т.п.)
  - `Net`: Код для сетевого взаимодействия.
  - `Utils`: Вспомогательные классы и сервисы (обработка ошибок, работа с аргументами командной строки)

### Объединение сцен и классов
Сцены и обработчики хранятся в одной папке. Например, в папке `ClientRoot` хранится `ClientRoot.tscn` (сцена) и `ClientRoot.cs` (обработчик).  
Обработчики могут быть разбиты на несколько `partial` классов по функционалу. Например, класс `ClientRoot` разбит на файлы `ClientRoot.cs`, `ClientRootSceneContainer.cs`, `ClientRootSingleton.cs`.

### Разделение на клиент и сервер
Сцены и обработчики для клиента и сервера хранятся в соседних папках. Например:
- **Root** (общая папка со всеми файлами связанными со сценой Root)
  - **ClientRoot** (папка с файлами сцены Root для клиента)
    - `ClientRoot.tscn`
    - `ClientRoot.cs`
    - `ClientRootSceneContainer.cs`
    - `ClientRootSingleton.cs`
  - **ServerRoot** (папка с файлами сцены Root для сервера)
    - `ServerRoot.tscn`
    - `ServerRoot.cs`
    - `ServerRootSceneContainer.cs`
    - `ServerRootSingleton.cs`
  - `RootService.cs` (статичный класс с общими функциями, которые используются и на клиенте и на сервере)

### Поток инициализации
1. `Root/StarterScene`
    - Является точкой входа и определяет, будет ли запускаться `ClientRoot` или `ServerRoot`.
2. `ClientRoot` / `ServerRoot`
    - Вызывает инициализацию других систем в `Init()` и запускает игру в `Start()`.
    - Является контейнером для `MainMenuMainScene` и `ClientGame` / `ServerGame`.
3. `ClientGame` / `ServerGame`
    - Инициализирует сеть и осуществляет подключение.
    - Является контейнером для `World`.
